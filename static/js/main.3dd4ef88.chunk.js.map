{"version":3,"sources":["reducers/reducer_csv_url.js","reducers/reducer_vectors_on_map.js","reducers/reducer_file_suffix.js","reducers/index.js","components/Footer/index.js","components/Map/Control.js","actions/index.js","components/Map/index.js","components/Navi/index.js","components/Plot/Legend.js","components/Plot/ToolTip.js","components/Plot/index.js","App.js","serviceWorker.js","index.js"],"names":["csvUrl","state","arguments","length","undefined","action","type","payload","vectorsOnMap","fileSuffix","rootReducer","combineReducers","Footer","react_default","a","createElement","className","href","target","React","Component","DumbControl","Control","extend","options","onOff","handleOff","onAdd","_controlDiv","DomUtil","create","this","DomEvent","disableClickPropagation","onRemove","map","off","withLeaflet","_MapControl","LeafletControl","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","apply","inherits","createClass","key","value","props","assign","forceUpdate","leafletElement","addTo","leaflet","getContainer","ReactDOM","createPortal","children","MapControl","getCsvUrl","getVectorsOnMap","getFileSuffix","BaseLayer","LayersControl","RISK_COLOR_SCALE","RISK_COLOR_HEX","chroma","scale","colors","RISK_VALUE_RANGE","RISK_VALUE_NAME","0","1","2","3","STRESS_COLOR_SCALE","STRESS_VALUE_RANGE","SAMPLE_FILES","ECOSYSTEM_LAYER","Hramap","_this","call","mapid","coordText","maxZoom","minZoom","maxBbox","lats","lngs","vectors","vectorLength","rasters","rasterLength","rastersOnMap","colorScale","colorRange","ecosystemRiskLayer","mapRef","createRef","layerControl","mapApi","current","renderLegend","files","isSampleData","_this2","geojsonUrls","i","keys","rasterName","removeFrom","forEach","filepath","fileExt","split","pop","filenameNoExt","values","fileObj","filename","name","replace","URL","createObjectURL","startsWith","slice","setState","loadVectors","e","filepaths","onFileUpload","vectorUrls","_this3","vectorData","vectorName","vectorPath","fetch","then","response","json","data","choropleth_default","features","valueProperty","feature","properties","steps","range","mode","style","getPolygonStyle","onEachFeature","layer","popupText","vectorBbox","bbox","push","concat","toConsumableArray","updateMaxBbox","minlat","Math","min","maxlat","max","minlng","maxlng","weight","opacity","color","fillColor","fillOpacity","fieldName","fieldValue","bindPopup","vectorsToRender","includes","_categories","_this4","layerControls","categories","defineProperty","ref","defaultChecked","onClick","handleVectorLayer","bind","_loop","prefix","position","checkBoxValue","filter","raster","_this5","updatedVectorsOnMap","index","indexOf","refs","checked","splice","layerName","latlng","lat","toFixed","lng","coords","fitBounds","legend","riskValue","riskName","riskColorHex","width","height","fill","_this6","Map","id","onMouseMove","renderMouseCoords","onMouseOut","removeCoords","backgroundColor","bounds","title","aria-label","zoomToMaxBbox","TileLayer","url","attribution","renderGeojsons","addLayerControls","onChange","webkitdirectory","mozdirectory","msdirectory","odirectory","directory","display","multiple","fileUpload","click","viewSample","ScaleControl","maxWidth","connect","dispatch","bindActionCreators","Navi","legendStyles",".legend","border","borderRadius","padding","wordBreak","marginLeft","float","textAlign",".legend li","lineHeight","paddingLeft","paddingBottom","fontSize",".legend .icon","background","left","top","marginTop","Legend","config","item","getIconColor","radium_lib","scopeSelector","rules","getList","PropTypes","array","toolTipStyles",".tooltip","paddingRight","paddingTop","ToolTip","riskPlots","showToolTip","dataToRender","colorConfig","legendColorConfig","nextProps","Papa","parse","header","download","skipEmptyLines","complete","results","convertData","csvData","habitatsOnMap","habitatsAll","row","subregion","habitatName","dataPoint","stressor","x","y","highRisk","medRisk","lowRisk","createColorConfig","palette","x_max","y_max","max_domain","lib","margin","right","bottom","axes","xTicks","yTicks","axisLabels","dotRadius","xDomainRange","yDomainRange","mouseOverHandler","mouseOutHandler","d","clientY","clientX","stressorName","conseqValue","Number","expoValue","Plot_ToolTip","Plot_Legend","createLegend","defaultParagraph","createScatterPlot","createTooltip","App","alert","window","chrome","webstore","opera","navigator","userAgent","InstallTrigger","components_Navi","components_Map","Plot","components_Footer","Boolean","location","hostname","match","store","createStore","render","es","src_App_0","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"gUASeA,EATA,WAA0B,IAAzBC,EAAyBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAjB,KAAMG,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACvC,OAAQC,EAAOC,MACb,IAAK,eACH,OAAOD,EAAOE,QAChB,QACE,OAAON,ICIEO,EATM,WAAwB,IAAvBP,EAAuBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAf,GAAIG,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAC3C,OAAQC,EAAOC,MACb,IAAK,kBACH,OAAOD,EAAOE,QAChB,QACE,OAAON,ICIEQ,EATI,WAAwB,IAAvBR,EAAuBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAf,GAAIG,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACzC,OAAQC,EAAOC,MACb,IAAK,kBACH,OAAOD,EAAOE,QAChB,QACE,OAAON,ICEES,EAFKC,YAAgB,CAAEX,SAAQQ,eAAcC,uDCa7CG,2LAbX,OACEC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,uBACXH,EAAAC,EAAAC,cAAA,MAAIC,UAAU,eACZH,EAAAC,EAAAC,cAAA,KAAGE,KAAK,2GACRC,OAAO,SADP,sBADF,OAIEL,EAAAC,EAAAC,cAAA,KAAGE,KAAK,8CAA8CC,OAAO,SAA7D,yCARSC,IAAMC,+FCKrBC,EAAcC,UAAQC,OAAO,CACjCC,QAAS,CACPR,UAAW,GACXS,MAAO,GACPC,UAAW,cAGbC,MAPiC,WAQ/B,IAAIC,EAAcC,UAAQC,OAAO,MAAOC,KAAKP,QAAQR,WAErD,OADAgB,WAASC,wBAAwBL,GAC1BA,GAGTM,SAbiC,SAaxBC,GAKP,OAJIJ,KAAKP,QAAQC,OACfU,EAAIC,IAAIL,KAAKP,QAAQC,MAAOM,KAAKP,QAAQE,UAAWK,MAG/CA,QAIIM,cAAW,SAAAC,GAAA,SAAAC,IAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAT,KAAAQ,GAAAC,OAAAE,EAAA,EAAAF,CAAAT,KAAAS,OAAAG,EAAA,EAAAH,CAAAD,GAAAK,MAAAb,KAAA7B,YAAA,OAAAsC,OAAAK,EAAA,EAAAL,CAAAD,EAAAD,GAAAE,OAAAM,EAAA,EAAAN,CAAAD,EAAA,EAAAQ,IAAA,uBAAAC,MAAA,SAEDC,GACnB,OAAO,IAAI5B,EAAYmB,OAAOU,OAAO,GAAID,MAHrB,CAAAF,IAAA,oBAAAC,MAAA,WAQpBjB,KAAKoB,cACLpB,KAAKqB,eAAeC,MAAMtB,KAAKkB,MAAMK,QAAQnB,OATzB,CAAAY,IAAA,SAAAC,MAAA,WAepB,OAAKjB,KAAKqB,gBAAmBrB,KAAKqB,eAAeG,eAG1CC,IAASC,aACd1B,KAAKkB,MAAMS,SACX3B,KAAKqB,eAAeG,gBAJb,SAhBWhB,EAAA,CACKoB,MC/BlBC,EAAY,SAAA5D,GAAM,MAAK,CAClCM,KAAM,eACNC,QAASP,IAGE6D,EAAkB,SAAArD,GAAY,MAAK,CAC9CF,KAAM,kBACNC,QAASC,IAGEsD,EAAgB,SAAArD,GAAU,MAAK,CAC1CH,KAAM,kBACNC,QAASE,oCCKHsD,wBAAcC,IAAdD,WAIFE,EAAmB,CAAC,OAAQ,WAC5BC,EAAiBC,IAAOC,MAAMH,GAAkBI,OAFlC,GAGdC,EAAmB,CAAC,EAAG,GACvBC,EAAkB,CACtBC,EAAG,WACHC,EAAG,WACHC,EAAG,cACHC,EAAG,aAECC,EAAqB,CAAC,UAAW,WACjCC,EAAqB,CAAC,EAAG,GAIzBC,EAAe,CAEnB,iCACA,gCACA,4BACA,kCACA,kCAGA,yCACA,4CACA,+BACA,8CAGA,0BASIC,EAAkB,yBAElBC,cAEJ,SAAAA,EAAY/B,GAAO,IAAAgC,EAAA,OAAAzC,OAAAC,EAAA,EAAAD,CAAAT,KAAAiD,IACjBC,EAAAzC,OAAAE,EAAA,EAAAF,CAAAT,KAAAS,OAAAG,EAAA,EAAAH,CAAAwC,GAAAE,KAAAnD,KAAMkB,KAEDhD,MAAQ,CACXkF,MAAO,SACPC,UAAW,mDACXC,QAAS,GACTC,QAAS,EACTC,QAAS,CAAC,EAAE,IAAK,KAAM,CAAC,GAAI,MAC5BC,KAAM,GACNC,KAAM,GACNC,QAAS,GACTC,aAAc,KACdnF,aAAc,GACdoF,QAAS,GACTC,aAAc,KACdC,aAAc,GACdC,WAAY,GACZC,WAAY,GACZC,mBAAoBlB,EACpBtE,WAAY,IAGdwE,EAAKiB,OAAS/E,IAAMgF,YACpBlB,EAAKmB,aAAejF,IAAMgF,YAxBTlB,mFA4BjBlD,KAAKsE,OAAStE,KAAKmE,OAAOI,QAAQlD,eAClCrB,KAAKwE,oDAKMC,EAAOC,GAOlB,IAPgC,IAAAC,EAAA3E,KAC5B4E,EAAc,GAEd3G,EAAS,KACTS,EAAa,GAGRmG,EAAI,EAAGA,EAAIpE,OAAOqE,KAAK9E,KAAK9B,MAAM6F,cAAc3F,OAAQyG,IAAK,CACpE,IAAIE,EAAa/E,KAAK9B,MAAM6F,aAAac,GACzC7E,KAAK9B,MAAM2F,QAAQkB,GAAYC,WAAWhF,KAAKsE,QAI5CI,EAwBHD,EAAMQ,QAAS,SAAAC,GAGb,IAAIC,EAAUD,EAASE,MAAM,KAAKC,MAC9BC,EAAgBJ,EAASE,MAAM,KAAK,GAAGA,MAAM,KAAKC,MAEtC,YAAZF,EACFP,EAAYU,GAAiBJ,EACR,QAAZC,IACTlH,EAASiH,KAhCbzE,OAAO8E,OAAOd,GAAOQ,QAAS,SAAAO,GAC5B,IAAIC,EAAWD,EAAQE,KACnBP,EAAUM,EAASL,MAAM,KAAKC,MAC9BC,EAAgBG,EAASE,QAAQ,IAAMR,EAAS,IAGpC,YAAZA,EAEFP,EAAYU,GAAiBM,IAAIC,gBAAgBL,GAC5B,QAAZL,GAIK,QAAZA,EAAoBG,EAAcQ,WAtEzB,wBAwEX7H,EAAS2H,IAAIC,gBAAgBL,GAC7B9G,EAAa4G,EAAcS,MAzEhB,qBAyEmC3H,WA0BpD4B,KAAKgG,SAAS,CACZrC,QAAS,GACTC,aAAc,KACdnF,aAAc,GACdoF,QAAS,GACTC,aAAc,KACdC,aAAc,GACdN,KAAM,GACNC,KAAM,GACNF,QAAS,CAAC,EAAE,IAAK,KAAM,CAAC,GAAI,MAC5B9E,WAAYA,EACZwF,mBAAoB,yBAA2BxF,GAC9C,WAGDiG,EAAKsB,YAAYrB,KAOnB5E,KAAKkB,MAAMW,UAAU5D,GACrB+B,KAAKkB,MAAMa,cAAcrD,sCAIhBwH,GACT,IAAMC,EAAYpD,EAAa3C,IAAI,SAAAsF,GAAI,MAAK,UAAYA,IACxD1F,KAAKoG,aAAaD,GAAW,uCAInBE,GAAY,IAAAC,EAAAtG,KAClByD,EAAO,GACPC,EAAO,GACP6C,EAAa,GAEjBvG,KAAKgG,SAAS,CAACpC,aAAcnD,OAAOqE,KAAKuB,GAAYjI,SAErDqC,OAAOqE,KAAKuB,GAAYpB,QAAS,SAAAuB,GAE/B,IAAIC,EAAaJ,EAAWG,GAE5BE,MAAMD,GACHE,KAAK,SAAAC,GAAQ,OAAIA,EAASC,SAC1BF,KAAK,SAAAG,GAIAA,EAAKpB,KAAKI,WAjJJ,iBAkJRQ,EAAKN,SAAS,CACZhC,WAAY9B,EACZ+B,WAAY1B,IAELuE,EAAKpB,KAAKI,WAvJP,cAwJZQ,EAAKN,SAAS,CACZhC,WAAYnB,EACZoB,WAAYnB,IAMhByD,EAAWC,GACT1H,EAAAC,EAAAC,cAAC+H,EAAAhI,EAAD,CACEiC,IAAK8F,EAAKpB,KACVoB,KAAM,CAACvI,KAAM,oBAAqByI,SAAUF,EAAKE,UACjDC,cACE,SAACC,GAEC,OAAIV,EAAWV,WAtKb,iBAuKOoB,EAAQC,WAjMX,cAkMKX,EAAWV,WAzKhB,aA0KGoB,EAAQC,WAAR,cADF,GAIX9E,MAAOiE,EAAKpI,MAAM8F,WAClBoD,MAnNM,EAoNNC,MAAOf,EAAKpI,MAAM+F,WAClBqD,KAAK,IACLC,MAAOjB,EAAKkB,kBACZC,cACE,SAACP,EAASQ,GAAV,OAAoBpB,EAAKqB,UAAUT,EAASQ,MAIlD,IAAIE,EAAaC,eAAKf,GACtBpD,EAAKoE,KAALjH,MAAA6C,EAAa,CAACkE,EAAW,GAAIA,EAAW,KACxCnE,EAAKqE,KAALjH,MAAA4C,EAAa,CAACmE,EAAW,GAAIA,EAAW,KAGpCnH,OAAO8E,OAAOgB,GAAYnI,SAAWkI,EAAKpI,MAAM0F,cAClD0C,EAAKN,SAAS,CAEZvH,aAAY,GAAAsJ,OAAAtH,OAAAuH,EAAA,EAAAvH,CACP6F,EAAKpI,MAAMO,cADJ,CACkB6H,EAAKpI,MAAMgG,qBACzCP,QAAS4C,EACT7C,KAAMA,EACND,KAAMA,GACL,WAGD6C,EAAKpF,MAAMY,gBAAgBwE,EAAKpI,MAAMO,cACtC6H,EAAK2B,8DASf,GAAIjI,KAAK9B,MAAMuF,KAAKrF,OAAS,GAAK4B,KAAK9B,MAAMwF,KAAKtF,OAAS,EAAG,CAE5D,IAAI8J,EAASC,KAAKC,IAALvH,MAAAsH,KAAI1H,OAAAuH,EAAA,EAAAvH,CAAQT,KAAK9B,MAAMuF,OAChC4E,EAASF,KAAKG,IAALzH,MAAAsH,KAAI1H,OAAAuH,EAAA,EAAAvH,CAAQT,KAAK9B,MAAMuF,OAChC8E,EAASJ,KAAKC,IAALvH,MAAAsH,KAAI1H,OAAAuH,EAAA,EAAAvH,CAAQT,KAAK9B,MAAMwF,OAChC8E,EAASL,KAAKG,IAALzH,MAAAsH,KAAI1H,OAAAuH,EAAA,EAAAvH,CAAQT,KAAK9B,MAAMwF,OACpC1D,KAAKgG,SAAS,CAACxC,QAAS,CAAC,CAAC0E,EAAQK,GAAQ,CAACF,EAAQG,iDAMrD,MAAO,CACLC,OAAQ,GACRC,QAAS,GACTC,MAAO,QACPC,UAAW,yBACXC,YAAa,sCAKP3B,EAASQ,GACjB,IAAMP,EAAaD,EAAQC,WAG3B1G,OAAOqE,KAAKqC,GAAYlC,QAAS,SAAA6D,GAC/B,GArQkB,eAqQdA,EAA+B,CACjC,IAAIC,EAAa5B,EAAW2B,GAC5BpB,EAAMsB,UAAUxG,EAAgBuG,SAEhCrB,EAAMsB,UAAUF,8CAUpB,IAAMnF,EAAU3D,KAAK9B,MAAMyF,QACrBlF,EAAeuB,KAAK9B,MAAMO,aAC5BwK,EAAkB,GAQtB,OANAxI,OAAOqE,KAAKnB,GAASsB,QAAS,SAAAuB,GACxB/H,EAAayK,SAAS1C,IACxByC,EAAgBnB,KAAKnE,EAAQ6C,MAI1ByC,6CAIU,IAAAE,EAAAC,EAAApJ,KAEX2D,EAAU3D,KAAK9B,MAAMyF,QACrBlF,EAAeuB,KAAK9B,MAAMO,aAC1ByF,EAAqBlE,KAAK9B,MAAMgG,mBAGlCmF,EAAgB,GAEdC,GAAUH,EAAA,GAAA1I,OAAA8I,EAAA,EAAA9I,CAAA0I,EAhRA,gBAgRmB,gBAAnB1I,OAAA8I,EAAA,EAAA9I,CAAA0I,EAjRI,YAiRkD,YAAtDA,GAEZjF,KAAsBP,GACxB0F,EAAcvB,KACZhJ,EAAAC,EAAAC,cAAA,SAAOgC,IAAKkD,GACVpF,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,SACET,KAAK,QAAQ0C,MAAOiD,EAAoBsF,IAAKtF,EAC7CjF,UAAU,kCACVwK,gBAAgB,EAChBC,QAAS1J,KAAK2J,kBAAkBC,KAAK5J,QAEvClB,EAAAC,EAAAC,cAAA,QAAMC,UAAW,aACdiF,EAAmByB,QA7Rd,gBA6RmC,IAAM,YAtBxC,IAAAkE,EAAA,SA4BRC,GAGPT,EAAcvB,KACZhJ,EAAAC,EAAAC,cAAA,OAAKgC,IAAK8I,EAAQ7K,UAAU,wBACzBqK,EAAWQ,KAMhBrJ,OAAOqE,KAAKnB,GAASsB,QAAS,SAAAuB,GAE5B,GAAIA,EAAWV,WAAWgE,GAAUtD,IAAetC,EAAoB,CAErE,GAAIzF,EAAayK,SAAS1C,IAG1B6C,EAAcvB,KACZhJ,EAAAC,EAAAC,cAAA,SAAOgC,IAAKwF,GACV1H,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,SACET,KAAK,WAAW0C,MAAOuF,EAAYgD,IAAKhD,EACxCvH,UAAU,kCACVwK,gBAVW,EAWXC,QAASN,EAAKO,kBAAkBC,KAAKR,KACvCtK,EAAAC,EAAAC,cAAA,YACGwH,EAAWb,QAAQmE,EAAQ,YA3B1C,IAAK,IAAIA,KAAUR,EAAYO,EAAtBC,GAoCT,GAAIT,EAAcjL,OAAS,EACzB,OACEU,EAAAC,EAAAC,cAACO,EAAD,CAASwK,SAAS,YAChBjL,EAAAC,EAAAC,cAAA,OACCC,UAAU,qEAERoK,8CAQOnD,GAChB,IAAM8D,EAAgB9D,EAAE/G,OAAO8B,MAC3BjB,KAAK9B,MAAM6F,aAAamF,SAASc,IACnChK,KAAKgG,SAAS,CAACjC,aAAc/D,KAAK9B,MAAM6F,aAAakG,OACnD,SAAAC,GAAM,OAAIA,IAAWF,MACvBhK,KAAK9B,MAAM2F,QAAQmG,GAAehF,WAAWhF,KAAKsE,UAElDtE,KAAKgG,SAAS,CAACjC,aAAY,GAAAgE,OAAAtH,OAAAuH,EAAA,EAAAvH,CACtBT,KAAK9B,MAAM6F,cADW,CACGiG,MAC9BhK,KAAK9B,MAAM2F,QAAQmG,GAAe1I,MAAMtB,KAAKsE,mDAK/B4B,GAAG,IAAAiE,EAAAnK,KACbgK,EAAgB9D,EAAE/G,OAAO8B,MACzBxC,EAAeuB,KAAK9B,MAAMO,aAC5B2L,EAAmB3J,OAAAuH,EAAA,EAAAvH,CAAOT,KAAK9B,MAAMO,cACnCyF,EAAqBlE,KAAK9B,MAAMgG,mBAGtC,GAAIzF,EAAayK,SAASc,GAAgB,CACxC,IAAIK,EAAQD,EAAoBE,QAAQN,GAEpCA,IAAkB9F,IACpBlE,KAAKuK,KAAKrG,GAAoBsG,SAAU,IAI3B,IAAXH,GACFD,EAAoBK,OAAOJ,EAAO,OAG/B,CAEL,GAAIL,IAAkB9F,EACnB,IAAK,IAAIW,EAAIuF,EAAoBhM,OAAS,EAAGyG,GAAK,EAAGA,IAAK,CACzD,IAAI6F,EAAYN,EAAoBvF,GAEpC,GAAI6F,EAAU5E,WA5XJ,iBA4X6B,CACrC,IAAIuE,EAAQD,EAAoBE,QAAQI,GACxCN,EAAoBK,OAAOJ,EAAO,GAClCrK,KAAKuK,KAAKG,GAAWF,SAAU,QAG9B,GAAI/L,EAAayK,SAAShF,GACtB8F,EAAclE,WAnYX,iBAmYoC,CAEhD,IAAIuE,EAAQD,EAAoBE,QAAQpG,GACxCkG,EAAoBK,OAAOJ,EAAO,GAClCrK,KAAKuK,KAAKrG,GAAoBsG,SAAU,EAG1CJ,EAAoBtC,KAAKkC,GAG3BhK,KAAKgG,SAAS,CAACvH,aAAc2L,GAAsB,WAEjDD,EAAKjJ,MAAMY,gBAAgBqI,EAAKjM,MAAMO,0DAMxByH,GAChB,IAAI7C,EAAY,QAAU6C,EAAEyE,OAAOC,IAAIC,QAAQ,GAClC,WAAW3E,EAAEyE,OAAOG,IAAID,QAAQ,GAC7C7K,KAAKgG,SAAS,CAAE3C,mDAIL6C,GACXlG,KAAKgG,SAAS,CAAC+E,OAAQ,6FAKvB/K,KAAKsE,OAAO0G,UAAUhL,KAAK9B,MAAMsF,gDAMjC,IAAIyH,EAAS,GAGbxK,OAAOqE,KAAKtC,GAAiByC,QAAS,SAAAiG,GACpC,IAAIC,EAAW3I,EAAgB0I,GAC3BE,EAAejJ,EAAe+I,GAElCD,EAAOnD,KACLhJ,EAAAC,EAAAC,cAAA,MAAIgC,IAAKmK,GACLrM,EAAAC,EAAAC,cAAA,OAAKC,UAAU,cACbH,EAAAC,EAAAC,cAAA,QAAMC,UAAU,aAAaoM,MAAM,OAAOC,OAAO,OAC3CC,KAAMH,KAEdtM,EAAAC,EAAAC,cAAA,QAAMC,UAAU,eAAekM,OAMvCF,EAAOnD,KACLhJ,EAAAC,EAAAC,cAAA,MAAIgC,IAAI,YACJlC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,cACbH,EAAAC,EAAAC,cAAA,QAAMC,UAAU,aAAaoM,MAAM,OAAOC,OAAO,OAC3CC,KAAM1I,EAAmB,MAEjC/D,EAAAC,EAAAC,cAAA,QAAMC,UAAU,eAAhB,cAINe,KAAKgG,SAAS,CAAEiF,4CAKT,IAAAO,EAAAxL,KACP,OACElB,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAACyM,EAAA,EAAD,CAAKjC,IAAKxJ,KAAKmE,OAAQuH,GAAI1L,KAAK9B,MAAMkF,MAAOnE,UAAU,MACrDqE,QAAStD,KAAK9B,MAAMoF,QAASC,QAASvD,KAAK9B,MAAMqF,QACjDoI,YAAa3L,KAAK4L,kBAAkBhC,KAAK5J,MACzC6L,WAAY7L,KAAK8L,aAAalC,KAAK5J,MACnCuH,MAAO,CAACwE,gBAAiB,WAAYC,OAAQhM,KAAK9B,MAAMsF,SAE1D1E,EAAAC,EAAAC,cAACO,EAAD,CAASwK,SAAS,WAChBjL,EAAAC,EAAAC,cAAA,UAAQ0M,GAAG,WAAWO,MAAM,cAAcC,aAAW,cACnDxC,QAAS1J,KAAKmM,cAAcvC,KAAK5J,OACjClB,EAAAC,EAAAC,cAAA,KAAGC,UAAU,6BAIjBH,EAAAC,EAAAC,cAACiD,EAAA,EAAD,CAAe8H,SAAS,WACtBjL,EAAAC,EAAAC,cAACgD,EAAD,CAAW0D,KAAK,kBAAkB8E,SAAS,GACzC1L,EAAAC,EAAAC,cAACoN,EAAA,EAAD,CACEC,IAAI,qDACJC,YAAY,6EAIhBxN,EAAAC,EAAAC,cAACgD,EAAD,CAAW0D,KAAK,kBACd5G,EAAAC,EAAAC,cAACoN,EAAA,EAAD,CACEC,IAAI,gGACJC,YAAY,sGAIhBxN,EAAAC,EAAAC,cAACgD,EAAD,CAAW0D,KAAK,sBACd5G,EAAAC,EAAAC,cAACoN,EAAA,EAAD,CACEC,IAAI,gGACJC,YAAY,6IAMjBtM,KAAKuM,iBAELvM,KAAKwM,mBAEN1N,EAAAC,EAAAC,cAACO,EAAD,CAASwK,SAAS,WAChBjL,EAAAC,EAAAC,cAAA,QAAMC,UAAU,sCAAhB,2BAGEH,EAAAC,EAAAC,cAAA,SAAOT,KAAK,OAAOiL,IAAI,aACrBiD,SAAU,SAAAvG,GAAC,OAAIsF,EAAKpF,aAAaF,EAAE/G,OAAOsF,OAAO,IACjDiI,gBAAgB,OAAOC,aAAa,OAAOC,YAAY,OACvDC,WAAW,OAAOC,UAAU,OAC5BvF,MAAO,CAACwF,QAAW,QAASC,UAAQ,IACtClO,EAAAC,EAAAC,cAAA,WAEAF,EAAAC,EAAAC,cAAA,SAAOT,KAAK,SAAS0C,MAAM,gBACzByI,QAAS,SAAAxD,GAAC,OAAIsF,EAAKjB,KAAK0C,WAAWC,WAXvC,iBAcEpO,EAAAC,EAAAC,cAAA,SAAOT,KAAK,SAAS0C,MAAM,eACzByI,QAAS,SAAAxD,GAAC,OAAIsF,EAAK2B,WAAWjH,QAKpCpH,EAAAC,EAAAC,cAACO,EAAD,CAASwK,SAAS,cAChBjL,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UAAUe,KAAK9B,MAAMmF,YAGtCvE,EAAAC,EAAAC,cAACO,EAAD,CAASwK,SAAS,cAAc/I,IAAI,UAClClC,EAAAC,EAAAC,cAAA,MAAIC,UAAU,UACXe,KAAK9B,MAAM+M,SAIhBnM,EAAAC,EAAAC,cAACoO,EAAA,EAAD,CAAcrD,SAAU,aAAcsD,SAAU,eAlhBnChO,aAuiBNiO,kBAbf,SAAyBpP,GACvB,MAAO,CACLD,OAAQC,EAAMD,OACdQ,aAAcP,EAAMO,aACpBC,WAAYR,EAAMQ,aAKtB,SAA4B6O,GAC1B,OAAOC,YAAmB,CAAE3L,YAAWC,kBAAiBC,iBAAiBwL,IAG5DD,CAA6CrK,GCvlB7CwK,2LATJ,IACCxB,EAAUjM,KAAKkB,MAAf+K,MACR,OACEnN,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UACbH,EAAAC,EAAAC,cAAA,MAAIC,UAAU,gBAAgBgN,WALnB7M,IAAMC,uFCGnBqO,GAAe,CACnBC,UAAW,CACTC,OAAQ,mBACR7B,gBAAiB,4BACjB8B,aAAc,MACdC,QAAS,MACTT,SAAU,QACVU,UAAW,YACXC,WAAY,QACZC,MAAO,OACPC,UAAW,QAEbC,aAAc,CACZ9C,MAAO,MACP+C,WAAY,OACZC,YAAa,OACbC,cAAe,MACfvE,SAAU,WACVwE,SAAU,OACVN,MAAO,QAETO,gBAAiB,CACfnD,MAAO,OACPC,OAAQ,OACRmD,WAAY,QACZZ,aAAc,MACd9D,SAAU,WACV2E,KAAM,MACNC,IAAK,MACLC,UAAW,SAmDAC,qLAtCH,IAAA3L,EAAAlD,KACR,OACEA,KAAKkB,MAAM4N,OAAO1O,IAChB,SAAC2O,EAAM1E,GAAP,OACEvL,EAAAC,EAAAC,cAAA,MAAIgC,IAAKqJ,GACPvL,EAAAC,EAAAC,cAAA,QACEC,UAAU,OACVsI,MAAO,CAAEwE,gBAAiB7I,EAAK8L,aAAa3E,MAE7C0E,EAAKxQ,6CAOH8L,GAKX,OAFIrK,KAAKkB,MADP4N,OAGYzE,GAAO1B,uCAIrB,OAAI3I,KAAKkB,MAAM4N,OAAO1Q,OAAS,EAE3BU,EAAAC,EAAAC,cAAA,OAAKC,UAAU,oBACbH,EAAAC,EAAAC,cAACiQ,GAAA,MAAD,CAAOC,cAAc,oBAAoBC,MAAOzB,KAChD5O,EAAAC,EAAAC,cAAA,MAAIC,UAAU,UAAUe,KAAKoP,YAI1B,yCAtCT,MAAO,CACLN,OAAQO,KAAUC,cAJHlQ,IAAMC,WCnCrBkQ,GAAgB,CACpBC,WAAY,CACV5B,OAAQ,qBACR7D,SAAU,WACVgC,gBAAiB,wBACjB8B,aAAc,MACdQ,YAAa,MACboB,aAAc,MACdC,WAAY,MACZpB,cAAe,MACfvB,QAAS,eACTwB,SAAU,OACVL,UAAW,WAmBAyB,GAfC,SAACzO,GAAD,OACdpC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,qBACbH,EAAAC,EAAAC,cAACiQ,GAAA,MAAD,CAAOC,cAAc,qBAAqBC,MAAOI,KACjDzQ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UAAUsI,MAAO,CAAEoH,IAAKzN,EAAMyN,IAAKD,KAAMxN,EAAMwN,OAC3DxN,EAAMS,YCEPiO,uBAEJ,SAAAA,EAAY1O,GAAO,IAAAgC,EAAA,OAAAzC,OAAAC,EAAA,EAAAD,CAAAT,KAAA4P,IACjB1M,EAAAzC,OAAAE,EAAA,EAAAF,CAAAT,KAAAS,OAAAG,EAAA,EAAAH,CAAAmP,GAAAzM,KAAAnD,KAAMkB,KACDhD,MAAQ,CACXD,OAAQiD,EAAMjD,OACdQ,aAAcyC,EAAMzC,aACpBC,WAAYwC,EAAMxC,WAClBmR,aAAa,EACbC,aAAc,GACdC,YAAa,GACbC,kBAAmB,IATJ9M,yFAaO+M,GAAW,IAAAtL,EAAA3E,KACV,OAArBiQ,EAAUhS,YAAuCI,IAArB4R,EAAUhS,QACxC+B,KAAKgG,SAAS,CACX/H,OAAQgS,EAAUhS,OAClBQ,aAAcwR,EAAUxR,aACxBC,WAAYuR,EAAUvR,YACtB,WAEDwR,IAAKC,MAAMF,EAAUhS,OAAQ,CAC3BmS,QAAQ,EACRC,UAAU,EACVC,gBAAgB,EAChBC,SAAU,SAAAC,GAAO,OAAI7L,EAAK8L,YAAYD,EAAQ1J,+CAO1C4J,GAEV,IAAMjS,EAAeuB,KAAK9B,MAAMO,aAC1BC,EAAasB,KAAK9B,MAAMQ,WAG1BoR,EAAe,GAGfa,EAAgB,GAGhBC,EAAc,GAElBnQ,OAAO8E,OAAOmL,GAASzL,QAAS,SAAA4L,GAC9B,IAAIC,EAAYD,EAAG,UAGfE,EAAcF,EAAG,QAAmBnS,EASxC,GANKkS,EAAY1H,SAAS6H,IACxBH,EAAY9I,KAAKiJ,GAKftS,EAAayK,SA/DH,gBA+D0B6H,IACpCtS,EAAayK,SAnEM,yBAmE0BxK,GAAa,CAGvDiS,EAAczH,SAAS6H,IAC1BJ,EAAc7I,KAAKiJ,GAIrB,IAAIC,EAAY,CACdzS,KAAMwS,EACNE,SAAUJ,EAAG,SACbK,EAAGL,EAAG,OACNM,EAAGN,EAAG,OACNO,SAAUP,EArFK,WAsFfQ,QAASR,EArFK,aAsFdS,QAAST,EArFK,WAyFXf,EAAagB,GAIhBhB,EAAagB,GAAWhJ,KAAKkJ,GAH7BlB,EAAagB,GAAa,CAACE,MAQjChR,KAAKgG,SAAS,CAAE8J,eAAcc,cAAaD,kBAC3C3Q,KAAKuR,gEAcL,IATA,IAAMX,EAAc5Q,KAAK9B,MAAM0S,YACzBD,EAAgB3Q,KAAK9B,MAAMyS,cAG3BrO,EAASkP,IAAQ,MAAOZ,EAAYxS,QAEtC2R,EAAc,GACdC,EAAoB,GAEfnL,EAAE,EAAGA,EAAI+L,EAAYxS,OAAQyG,IAAK,CACzC,IAAIkM,EAAcH,EAAY/L,GAG9BkL,EAAYjI,KACV,CACEvJ,KAAMwS,EACNpI,MAAO,IAAMrG,EAAOuC,KAKpB8L,EAAczH,SAAS6H,IACzBf,EAAkBlI,KAChB,CACEvJ,KAAMwS,EACNpI,MAAO,IAAMrG,EAAOuC,KAMxBkL,EAAY3R,SAAWwS,EAAYxS,SACrC4B,KAAKgG,SAAS,CAAE+J,gBAChB/P,KAAKgG,SAAS,CAAEgK,mEAIA,IAAA1J,EAAAtG,KAClB,GAAKA,KAAK9B,MAAM4R,aAAe,CAC7B,IAAMA,EAAe9P,KAAK9B,MAAM4R,aAmChC,OAlCmBrP,OAAOqE,KAAKgL,GACC1P,IAAK,SAAA0Q,GAEnC,IAAMW,EAAQtJ,KAAKG,IAAIzH,MACrBsH,KAAM1H,OAAO8E,OACXuK,EAAagB,IAAY1Q,IAAI,SAAA4Q,GAAS,OAAIA,EAAUE,KAClDQ,EAAQvJ,KAAKG,IAAIzH,MACrBsH,KAAM1H,OAAO8E,OACXuK,EAAagB,IAAY1Q,IAAI,SAAA4Q,GAAS,OAAIA,EAAUG,KAElDQ,EAAsC,IAAzBxJ,KAAKG,IAAImJ,EAAOC,GAEnC,OAAQ5S,EAAAC,EAAAC,cAAA,OAAKgC,IAAK8P,GAChBhS,EAAAC,EAAAC,cAAA,UAAK8R,GACLhS,EAAAC,EAAAC,cAAC4S,GAAA,iBAAD,CACE5Q,IAAK8P,EACLhK,KAAMgJ,EAAagB,GACnBe,OAAQ,CAAClD,IAAK,GAAImD,MAAO,EAAGC,OAAQ,GAAIrD,KAAM,IAC9CI,OAAQxI,EAAKpI,MAAM6R,YACnBiC,MAAI,EACJC,OAAQ,EACRC,OAAQ,EACRC,WAAY,CAACjB,EAAG,WAAYC,EAAG,eAC/BiB,UAAW,EACX/G,MAAO,IACPC,OAAQ,IACR+G,aAAc,CAAC,EAAGV,GAClBW,aAAc,CAAC,EAAGX,GAClBY,iBAAkBjM,EAAKiM,iBAAiB3I,KAAKtD,GAC7CkM,gBAAiBlM,EAAKkM,gBAAgB5I,KAAKtD,kDAUpCmM,EAAGvM,GAClBlG,KAAKgG,SAAS,CACZ6J,aAAa,EACblB,IAAG,GAAA5G,OAAK7B,EAAEwM,QAAU,GAAjB,MACHhE,KAAI,GAAA3G,OAAK7B,EAAEyM,QAA8B,IAApBF,EAAExB,SAAS7S,OAA5B,MACJ2S,YAAa0B,EAAElU,KACfqU,aAAcH,EAAExB,SAChB4B,YAAaC,OAAOL,EAAEtB,GACtB4B,UAAWD,OAAOL,EAAEvB,+CAKtBlR,KAAKgG,SAAS,CAAE6J,aAAa,4CAI7B,QAAI7P,KAAK9B,MAAM2R,aAEX/Q,EAAAC,EAAAC,cAACgU,GAAD,CAASrE,IAAK3O,KAAK9B,MAAMyQ,IAAKD,KAAM1O,KAAK9B,MAAMwQ,MAC7C5P,EAAAC,EAAAC,cAAA,QAAMC,UAAU,iBAAhB,IAAkCe,KAAK9B,MAAM0U,aAA7C,KACA9T,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,QAAMC,UAAU,iBAAhB,IAAkCe,KAAK9B,MAAM6S,YAA7C,KACAjS,EAAAC,EAAAC,cAAA,WAJF,MAKMgB,KAAK9B,MAAM6U,UAAUlI,QAAQ,GALnC,QAMM7K,KAAK9B,MAAM2U,YAAYhI,QAAQ,2CASzC,GAAKpK,OAAO8E,OAAOvF,KAAK9B,MAAM4R,cAAc1R,OAAS,EACnD,OACEU,EAAAC,EAAAC,cAAA,OAAKC,UAAU,cACbH,EAAAC,EAAAC,cAACiU,GAAD,CAAQnE,OAAQ9O,KAAK9B,MAAM8R,gEAejC,OAAKhQ,KAAK9B,MAAMD,OAQP,KANLa,EAAAC,EAAAC,cAAA,OAAKC,UAAU,aACbH,EAAAC,EAAAC,cAAA,SAXc,kEAYdF,EAAAC,EAAAC,cAAA,SATc,0PAmBpB,OACEF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,kBACbH,EAAAC,EAAAC,cAAA,MAAIC,UAAU,UAAd,cAECe,KAAKkT,eAELlT,KAAKmT,mBAELnT,KAAKoT,oBAELpT,KAAKqT,wBA3PUhU,cAwQTiO,eANS,SAAApP,GAAK,MAAK,CAChCD,OAAQC,EAAMD,OACdQ,aAAcP,EAAMO,aACpBC,WAAYR,EAAMQ,aAGL4O,CAAyBsC,ICzPzB0D,uBAjCb,SAAAA,EAAYpS,GAAO,IAAAgC,EAAA,OAAAzC,OAAAC,EAAA,EAAAD,CAAAT,KAAAsT,IACjBpQ,EAAAzC,OAAAE,EAAA,EAAAF,CAAAT,KAAAS,OAAAG,EAAA,EAAAH,CAAA6S,GAAAnQ,KAAAnD,KAAOkB,KACFhD,MAAQ,CACX+N,MAAO,2BAHQ/I,4EAQNqQ,MAEMC,OAAOC,UAAYD,OAAOC,OAAOC,aAElCF,OAAOG,OAASC,UAAUC,UAAUvJ,QAAQ,UAAY,GAE9B,qBAAnBwJ,gBAGrBN,OAAOD,MAAM,mIAKf,OACEzU,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OACbH,EAAAC,EAAAC,cAAC+U,EAAD,CAAM9H,MAAOjM,KAAK9B,MAAM+N,QACxBnN,EAAAC,EAAAC,cAACgV,EAAD,MACAlV,EAAAC,EAAAC,cAACiV,GAAD,MACAnV,EAAAC,EAAAC,cAACkV,EAAD,cA7BU7U,cCKE8U,QACW,cAA7BX,OAAOY,SAASC,UAEe,UAA7Bb,OAAOY,SAASC,UAEhBb,OAAOY,SAASC,SAASC,MACvB,sECTAC,GAAQC,YAAY7V,GAE1B8C,IAASgT,OACP3V,EAAAC,EAAAC,cAAC0V,EAAA,EAAD,CAAUH,MAAOA,IACfzV,EAAAC,EAAAC,cAAC2V,GAAD,OAEFC,SAASC,eAAe,SDkHpB,kBAAmBjB,WACrBA,UAAUkB,cAAcC,MAAMpO,KAAK,SAAAqO,GACjCA,EAAaC","file":"static/js/main.3dd4ef88.chunk.js","sourcesContent":["const csvUrl = (state = null, action) => {\n  switch (action.type) {\n    case 'CSV_UPLOADED':\n      return action.payload\n    default:\n      return state\n    }\n  }\n\nexport default csvUrl;\n","const vectorsOnMap = (state = [], action) => {\n  switch (action.type) {\n    case 'VECTORS_UPDATED':\n      return action.payload\n    default:\n      return state\n    }\n  }\n\nexport default vectorsOnMap;\n","const fileSuffix = (state = '', action) => {\n  switch (action.type) {\n    case 'SUFFIX_OBTAINED':\n      return action.payload\n    default:\n      return state\n    }\n  }\n\nexport default fileSuffix;\n","import { combineReducers } from 'redux';\nimport csvUrl from './reducer_csv_url';\nimport vectorsOnMap from './reducer_vectors_on_map';\nimport fileSuffix from './reducer_file_suffix';\n\nconst rootReducer = combineReducers({ csvUrl, vectorsOnMap, fileSuffix });\n\nexport default rootReducer;\n","import React from 'react';\nimport './style.css';\n\nclass Footer extends React.Component {\n  render() {\n    return (\n      <div className=\"footer fixed-bottom\">\n          <h5 className='footer-text'>\n            <a href=\"http://data.naturalcapitalproject.org/nightly-build/invest-users-guide/html/habitat_risk_assessment.html\"\n            target=\"blank\">InVEST User Guide </a>\n            &copy;\n            <a href=\"https://naturalcapitalproject.stanford.edu/\" target=\"blank\">2019 Natural Capital Project</a>\n          </h5>\n      </div>\n    );\n  }\n}\n\nexport default Footer;\n","// This is from https://github.com/LiveBy/react-leaflet-control/issues/27.\n// the codesandbox snippet by bslipek to solve the issue that the contents\n// of <Control> do not get rendered on initial <Map> display.\n\nimport ReactDOM from \"react-dom\";\nimport { MapControl, withLeaflet } from \"react-leaflet\";\nimport { Control, DomUtil, DomEvent } from \"leaflet\";\n\nconst DumbControl = Control.extend({\n  options: {\n    className: \"\",\n    onOff: \"\",\n    handleOff: function noop() {}\n  },\n\n  onAdd(/* map */) {\n    var _controlDiv = DomUtil.create(\"div\", this.options.className);\n    DomEvent.disableClickPropagation(_controlDiv);\n    return _controlDiv;\n  },\n\n  onRemove(map) {\n    if (this.options.onOff) {\n      map.off(this.options.onOff, this.options.handleOff, this);\n    }\n\n    return this;\n  }\n});\n\nexport default withLeaflet(\n  class LeafletControl extends MapControl {\n    createLeafletElement(props) {\n      return new DumbControl(Object.assign({}, props));\n    }\n\n    componentDidMount() {\n      // Here is a little trick\n      this.forceUpdate();\n      this.leafletElement.addTo(this.props.leaflet.map);\n      // for leaflet 1.x\n      // this.leafletElement.addTo(this.context.map)\n    }\n\n    render() {\n      if (!this.leafletElement || !this.leafletElement.getContainer()) {\n        return null;\n      }\n      return ReactDOM.createPortal(\n        this.props.children,\n        this.leafletElement.getContainer()\n      );\n    }\n  }\n);\n","export const getCsvUrl = csvUrl => ({\n  type: 'CSV_UPLOADED',\n  payload: csvUrl\n});\n\nexport const getVectorsOnMap = vectorsOnMap => ({\n  type: 'VECTORS_UPDATED',\n  payload: vectorsOnMap\n});\n\nexport const getFileSuffix = fileSuffix => ({\n  type: 'SUFFIX_OBTAINED',\n  payload: fileSuffix\n});","import { bbox } from \"@turf/turf\"\nimport { bindActionCreators } from \"redux\";\nimport { connect } from \"react-redux\";\n\nimport chroma from \"chroma-js\";\nimport Choropleth from \"react-leaflet-choropleth\";\nimport Control from \"./Control\";\nimport { getCsvUrl } from \"../../actions/index\";\nimport { getVectorsOnMap } from \"../../actions/index\";\nimport { getFileSuffix } from \"../../actions/index\";\nimport { Map, TileLayer, LayersControl, ScaleControl } from \"react-leaflet\";\nimport React, { Component } from \"react\";\n\nimport \"font-awesome/css/font-awesome.min.css\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"./style.css\";\n\nconst { BaseLayer } = LayersControl;\n\n// Color parameters for habitat risk categories and stressors\nconst COLOR_STEPS = 4;\nconst RISK_COLOR_SCALE = ['#fff', '#aa0101'];\nconst RISK_COLOR_HEX = chroma.scale(RISK_COLOR_SCALE).colors(COLOR_STEPS);\nconst RISK_VALUE_RANGE = [0, 3]; // for getting color hex for value 0 to 3\nconst RISK_VALUE_NAME = {\n  0: 'No Score',\n  1: 'Low Risk',\n  2: 'Medium Risk',\n  3: 'High Risk'\n};\nconst STRESS_COLOR_SCALE = [\"#d95f0e\", \"#d95f0e\"];\nconst STRESS_VALUE_RANGE = [1, 1];\nconst RISK_FIELD_NAME = \"Risk Score\";\nconst STRESSOR_FIELD_NAME = \"Stressor\"\n\nconst SAMPLE_FILES = [\n  // Habitat risk vectors\n  \"RECLASS_RISK_Ecosystem.geojson\",\n  \"RECLASS_RISK_eelgrass.geojson\",\n  \"RECLASS_RISK_kelp.geojson\",\n  \"RECLASS_RISK_hardbottom.geojson\",\n  \"RECLASS_RISK_softbottom.geojson\",\n\n  // Stressor vectors\n  \"STRESSOR_Docks_Wharves_Marinas.geojson\",\n  \"STRESSOR_Finfish_Aquaculture_Comm.geojson\",\n  \"STRESSOR_Rec_Fishing.geojson\",\n  \"STRESSOR_Shellfish_Aquaculture_Comm.geojson\",\n\n  // Criteria score zonal statistics on each habitat-stressor pair\n  \"SUMMARY_STATISTICS.csv\"\n];\n\n// CSV file basename.\nconst CSV_BASENAME = \"SUMMARY_STATISTICS\";\n\n// We will only render raster files starting with these prefixes\nconst STRESSOR_PREFIX = \"STRESSOR_\"\nconst RISK_PREFIX = \"RECLASS_RISK_\"\nconst ECOSYSTEM_LAYER = \"RECLASS_RISK_Ecosystem\"\n\nclass Hramap extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      mapid: \"mapdiv\",\n      coordText: \"Hover mouse over the map to display coordinates.\",\n      maxZoom: 18,\n      minZoom: 2, // global scale\n      maxBbox: [[-90, -180], [90, 180]],\n      lats: [],\n      lngs: [],\n      vectors: {},\n      vectorLength: null,\n      vectorsOnMap: [],\n      rasters: {},\n      rasterLength: null,\n      rastersOnMap: [],\n      colorScale: [],\n      colorRange: [],\n      ecosystemRiskLayer: ECOSYSTEM_LAYER, // Default layer on map when user choose to view sample files\n      fileSuffix: \"\",\n    };\n\n    this.mapRef = React.createRef();\n    this.layerControl = React.createRef();\n  }\n\n  componentDidMount() {\n    this.mapApi = this.mapRef.current.leafletElement; // the Leaflet Map object\n    this.renderLegend();\n  }\n\n  // Read the target files from the event listener when users upload folder,\n  // read the files within the folder and set states accordingly\n  onFileUpload(files, isSampleData) {\n    let geojsonUrls = {};\n    // let geotiffUrls = {};\n    let csvUrl = null;\n    let fileSuffix = \"\";\n\n    // Remove preexisting rasters from map\n    for (let i = 0; i < Object.keys(this.state.rastersOnMap).length; i++) {\n      let rasterName = this.state.rastersOnMap[i];\n      this.state.rasters[rasterName].removeFrom(this.mapApi);\n    }\n\n    // If the files are uploaded by user, store them as blob URL\n    if (!isSampleData) {\n      Object.values(files).forEach( fileObj => {\n        let filename = fileObj.name;\n        let fileExt = filename.split(\".\").pop();\n        let filenameNoExt = filename.replace(\".\" + fileExt, \"\");\n\n        // Use URLs to reference to the blob, and push them to the dictionary\n        if (fileExt === \"geojson\") {\n          // Use createObjectURL() to return blob URL as a string\n          geojsonUrls[filenameNoExt] = URL.createObjectURL(fileObj);\n        } else if (fileExt === \"tif\") {\n          //! do not render rasters for now yet because output files are GeoJSON\n          // geotiffUrls[filenameNoExt] = URL.createObjectURL(fileObj);\n        } else if (\n            fileExt === \"csv\" & filenameNoExt.startsWith(CSV_BASENAME)) {\n          // Create CSV object URL\n          csvUrl = URL.createObjectURL(fileObj);\n          fileSuffix = filenameNoExt.slice(CSV_BASENAME.length);\n        }\n      });\n\n    } else {\n      // If users want to view sample files, save URLs of the hosted GeoJSON\n      // and CSV files\n      files.forEach( filepath => {\n\n        // Save sample file names and paths to geojsonUrls\n        let fileExt = filepath.split(\".\").pop();\n        let filenameNoExt = filepath.split(\".\")[1].split(\"/\").pop()\n\n        if (fileExt === \"geojson\") {\n          geojsonUrls[filenameNoExt] = filepath;\n        } else if (fileExt === \"csv\") {\n          csvUrl = filepath;\n        } else if (fileExt === \"tif\") {\n          //! do not render rasters for now yet because output files are GeoJSON\n          // geotiffUrls[filenameNoExt] = filepath;\n        }\n      });\n    }\n\n    // When all object URLs are retrieved, clean up preexisting states\n    // since we will update them when new data is rendered\n    this.setState({\n      vectors: {},\n      vectorLength: null,\n      vectorsOnMap: [],\n      rasters: {},\n      rasterLength: null,\n      rastersOnMap: [],\n      lats: [],\n      lngs: [],\n      maxBbox: [[-90, -180], [90, 180]],\n      fileSuffix: fileSuffix,\n      ecosystemRiskLayer: \"RECLASS_RISK_Ecosystem\" + fileSuffix,\n    }, () =>\n\n    { // Fetch vector data and create styled polygons from the URLs\n      this.loadVectors(geojsonUrls);\n\n      //! do not render rasters for now yet because output files are GeoJSON\n      // this.loadAndRenderRasters(geotiffUrls);\n    });\n\n    // Update csv url and file suffix reducers\n    this.props.getCsvUrl(csvUrl);\n    this.props.getFileSuffix(fileSuffix);\n  }\n\n  // Load sample files to the page when users click on the View Sample button\n  viewSample(e) {\n    const filepaths = SAMPLE_FILES.map(name => (\"./data/\" + name) );\n    this.onFileUpload(filepaths, true);\n  }\n\n  // Read GeoJSON files and save them in the vectors state.\n  loadVectors(vectorUrls) {\n    let lats = [];\n    let lngs = [];\n    let vectorData = {};\n\n    this.setState({vectorLength: Object.keys(vectorUrls).length});\n\n    Object.keys(vectorUrls).forEach( vectorName => {\n      // Fetch GeoJSON data via their path and store the data in vectors\n      let vectorPath = vectorUrls[vectorName];\n\n      fetch(vectorPath)\n        .then(response => response.json()) // parse the data as JSON\n        .then(data => {\n\n          // Get suitable color scales and field name for rendering risk and\n          // stressor vectors\n          if (data.name.startsWith(RISK_PREFIX)) {\n            this.setState({\n              colorScale: RISK_COLOR_SCALE,\n              colorRange: RISK_VALUE_RANGE\n            });\n          } else if (data.name.startsWith(STRESSOR_PREFIX)) {\n            this.setState({\n              colorScale: STRESS_COLOR_SCALE,\n              colorRange: STRESS_VALUE_RANGE\n            });\n          }\n\n          // Add gradient color to features based on the field names (either\n          // `Risk Score` or `stressor Potential`)\n          vectorData[vectorName] = (\n            <Choropleth\n              key={data.name}\n              data={{type: \"FeatureCollection\", features: data.features}}\n              valueProperty={\n                (feature) => {\n                  // Get field values of 0 to 3 given a right vector format\n                  if (vectorName.startsWith(RISK_PREFIX)) {\n                    return feature.properties[RISK_FIELD_NAME];\n                  } else if (vectorName.startsWith(STRESSOR_PREFIX)) {\n                    return feature.properties[STRESSOR_FIELD_NAME];\n                  }\n                }}\n              scale={this.state.colorScale}\n              steps={COLOR_STEPS}\n              range={this.state.colorRange}\n              mode=\"e\"  // for equidistant color mode\n              style={this.getPolygonStyle()}\n              onEachFeature={\n                (feature, layer) => this.popupText(feature, layer)}\n            />);\n\n          // Add GeoJSON bounding box to lat and long arrays\n          let vectorBbox = bbox(data);\n          lngs.push(...[vectorBbox[0], vectorBbox[2]]);\n          lats.push(...[vectorBbox[1], vectorBbox[3]]);\n\n          // Only set state when all vector data are loaded\n          if (Object.values(vectorData).length === this.state.vectorLength) {\n            this.setState({\n              // Turn on the ecosystem risk layer in the first render\n              vectorsOnMap: [\n                ...this.state.vectorsOnMap, this.state.ecosystemRiskLayer],\n              vectors: vectorData,\n              lngs: lngs,\n              lats: lats\n            }, () =>\n\n            { // Update vectorsOnMap reducer\n              this.props.getVectorsOnMap(this.state.vectorsOnMap);\n              this.updateMaxBbox();\n            });\n          }\n        });\n    });\n  }\n\n  // Calculate the union of all the bounding boxes of geojson files.\n  updateMaxBbox() {\n    if (this.state.lats.length > 0 && this.state.lngs.length > 0) {\n      // Calculate the min and max longitude and latitude\n      let minlat = Math.min(...this.state.lats),\n          maxlat = Math.max(...this.state.lats);\n      let minlng = Math.min(...this.state.lngs),\n          maxlng = Math.max(...this.state.lngs);\n      this.setState({maxBbox: [[minlat, minlng],[maxlat, maxlng]]});\n    }\n  }\n\n  // Basic style for polygons\n  getPolygonStyle() {\n    return {\n      weight: 0.5,\n      opacity: 0.8,\n      color: \"black\",\n      fillColor: \"rgba(255, 255, 255, 0)\",\n      fillOpacity: 0.8\n    };\n  }\n\n  // Pop up field names and values when user clicks on a GeoJSON feature\n  popupText(feature, layer) {\n    const properties = feature.properties;\n\n    // Add text to the pop-up with all the field names & values for each feature\n    Object.keys(properties).forEach( fieldName => {\n      if (fieldName === RISK_FIELD_NAME) {\n        let fieldValue = properties[fieldName];\n        layer.bindPopup(RISK_VALUE_NAME[fieldValue]);\n      } else {  // fieldName === STRESSOR_FIELD_NAME, just show the field name\n        layer.bindPopup(fieldName)\n      }\n\n    });\n\n  }\n\n  // Render geojson vectors based on the vectorsOnMap, whose values change\n  // according to the checkbox events\n  renderGeojsons() {\n    const vectors = this.state.vectors; // has all the vector data by name\n    const vectorsOnMap = this.state.vectorsOnMap;\n    let vectorsToRender = [];\n\n    Object.keys(vectors).forEach( vectorName => {\n      if (vectorsOnMap.includes(vectorName)) {\n        vectorsToRender.push(vectors[vectorName]);\n      }\n    });\n\n    return vectorsToRender;\n  }\n\n  // Add titles and check boxes for raster and vector layers\n  addLayerControls() {\n    // const rasters = this.state.rasters;\n    const vectors = this.state.vectors;\n    const vectorsOnMap = this.state.vectorsOnMap;\n    const ecosystemRiskLayer = this.state.ecosystemRiskLayer;\n\n    // Create toggle switch for Risk/stressor first\n    let layerControls = [];\n\n    const categories = {[RISK_PREFIX]: 'Habitat Risk', [STRESSOR_PREFIX]: 'Stressor'}\n\n    if (ecosystemRiskLayer in vectors) {\n      layerControls.push(\n        <label key={ecosystemRiskLayer}>\n          <div>\n            <input\n              type=\"radio\" value={ecosystemRiskLayer} ref={ecosystemRiskLayer}\n              className=\"leaflet-control-layers-selector\"\n              defaultChecked={true} // checked\n              onClick={this.handleVectorLayer.bind(this)}/>\n\n            <span className={\"bold-font\"}>\n              {ecosystemRiskLayer.replace(RISK_PREFIX, \"\") + \" Risk\"}\n            </span>\n          </div>\n        </label>);\n    }\n\n    for (let prefix in categories) {\n\n      // Add the category name to the control with its first letter capitalized\n      layerControls.push(\n        <div key={prefix} className=\"control-layer-header\">\n          {categories[prefix]}\n        </div>\n      );\n\n      // If vector name starts with 'RECLASS_RISK' or 'STRESSOR_', put them on\n      // the control box and remove the front suffix from the names\n      Object.keys(vectors).forEach( vectorName => {\n        // If layer name is in the vectorsOnMap array, set it checked\n        if (vectorName.startsWith(prefix) & vectorName !== ecosystemRiskLayer) {\n          let defaultCheck = false; // Boolean variable for setting default layer check box\n          if (vectorsOnMap.includes(vectorName)) {\n            let defaultCheck = true;\n          }\n          layerControls.push(\n            <label key={vectorName}>\n              <div>\n                <input\n                  type=\"checkbox\" value={vectorName} ref={vectorName}\n                  className=\"leaflet-control-layers-selector\"\n                  defaultChecked={defaultCheck}\n                  onClick={this.handleVectorLayer.bind(this)}/>\n                <span>\n                  {vectorName.replace(prefix, \"\")}\n                </span>\n              </div>\n            </label>);\n        }\n      });\n    }\n\n    // When the control has layers, not just the category names\n    if (layerControls.length > 2) {\n      return (\n        <Control position=\"topright\">\n          <div\n           className=\"leaflet-control-layers\n                      leaflet-control-layers-expanded indent-box\">\n            {layerControls}\n          </div>\n        </Control>\n      );\n    }\n  }\n\n  // Turn raster layers on or off depending on the checkbox value\n  handleRasterLayer(e) {\n    const checkBoxValue = e.target.value;\n    if (this.state.rastersOnMap.includes(checkBoxValue)) {\n      this.setState({rastersOnMap: this.state.rastersOnMap.filter(\n        raster => raster !== checkBoxValue)});\n      this.state.rasters[checkBoxValue].removeFrom(this.mapApi);\n    } else {\n      this.setState({rastersOnMap: [\n        ...this.state.rastersOnMap, checkBoxValue]});\n      this.state.rasters[checkBoxValue].addTo(this.mapApi);\n    }\n  }\n\n  // Turn vector layers on or off depending on the checkbox value\n  handleVectorLayer(e) {\n    const checkBoxValue = e.target.value;\n    const vectorsOnMap = this.state.vectorsOnMap;\n    let updatedVectorsOnMap = [...this.state.vectorsOnMap];\n    const ecosystemRiskLayer = this.state.ecosystemRiskLayer;\n\n    // Turn off the layer if it's on map\n    if (vectorsOnMap.includes(checkBoxValue)) {\n      let index = updatedVectorsOnMap.indexOf(checkBoxValue);\n\n      if (checkBoxValue === ecosystemRiskLayer) {\n        this.refs[ecosystemRiskLayer].checked = false; // Uncheck the ecosystem layer\n      }\n\n      // Remove the layer from the list\n      if (index !== -1) {\n        updatedVectorsOnMap.splice(index, 1);\n      }\n\n    } else {\n      // Turn off all the other risk layers if ecosystem risk layer is checked\n      if (checkBoxValue === ecosystemRiskLayer) {\n         for (let i = updatedVectorsOnMap.length - 1; i >= 0; i--) {\n          let layerName = updatedVectorsOnMap[i];\n\n          if (layerName.startsWith(RISK_PREFIX)) {\n            let index = updatedVectorsOnMap.indexOf(layerName);\n            updatedVectorsOnMap.splice(index, 1);\n            this.refs[layerName].checked = false; // Uncheck the layer from control\n          }\n         }\n      } else if (vectorsOnMap.includes(ecosystemRiskLayer) &\n                 checkBoxValue.startsWith(RISK_PREFIX)) {\n        // Turn off the ecosystem layer if a habitat risk layer is checked\n        let index = updatedVectorsOnMap.indexOf(ecosystemRiskLayer);\n        updatedVectorsOnMap.splice(index, 1);\n        this.refs[ecosystemRiskLayer].checked = false;\n      }\n      // Turn on the layer if it's not on map\n      updatedVectorsOnMap.push(checkBoxValue);\n    }\n\n    this.setState({vectorsOnMap: updatedVectorsOnMap}, () => {\n      // Update vectorsOnMap reducer\n      this.props.getVectorsOnMap(this.state.vectorsOnMap);\n    });\n\n  }\n\n  // Display lat and long coordinates based on mouse event\n  renderMouseCoords(e) {\n    let coordText = \"Lat: \" + e.latlng.lat.toFixed(5) +\n                 \", Long: \"+e.latlng.lng.toFixed(5);\n    this.setState({ coordText });\n  }\n\n  // Remove the display of coords when mouse leaves the map\n  removeCoords(e) {\n    this.setState({coords: \"Hover mouse over the map to display coordinates.\"});\n  }\n\n  // Zoom to the union of bounding boxes of all layers\n  zoomToMaxBbox() {\n    this.mapApi.fitBounds(this.state.maxBbox);\n  }\n\n  // Display the risk and resilience legends\n  renderLegend() {\n\n    let legend = [];\n\n    // Risk legend\n    Object.keys(RISK_VALUE_NAME).forEach( riskValue => {\n      let riskName = RISK_VALUE_NAME[riskValue];\n      let riskColorHex = RISK_COLOR_HEX[riskValue];\n      // Set rect size here, because the rect css does not work in firefox\n      legend.push(\n        <li key={riskName}>\n            <svg className='legend-svg'>\n              <rect className='legend-svg' width='28px' height='18px'\n                    fill={riskColorHex}/>\n            </svg>\n            <span className='legend-text'>{riskName}</span>\n        </li>\n      );\n    });\n\n    // stressor legend\n    legend.push(\n      <li key=\"stressor\">\n          <svg className='legend-svg'>\n            <rect className='legend-svg' width='28px' height='18px'\n                  fill={STRESS_COLOR_SCALE[0]}/>\n          </svg>\n          <span className='legend-text'>Stressor</span>\n      </li>\n    );\n\n    this.setState({ legend });\n  }\n\n\n\n  render() {\n    return (\n      <div>\n        <Map ref={this.mapRef} id={this.state.mapid} className=\"map\"\n          maxZoom={this.state.maxZoom} minZoom={this.state.minZoom}\n          onMouseMove={this.renderMouseCoords.bind(this)}\n          onMouseOut={this.removeCoords.bind(this)}\n          style={{backgroundColor: \"#aad3df\"}} bounds={this.state.maxBbox}>\n\n        <Control position=\"topleft\">\n          <button id=\"zoom-btn\" title=\"Zoom To AOI\" aria-label=\"Zoom To AOI\"\n            onClick={this.zoomToMaxBbox.bind(this)}>\n            <i className=\"fa fa-crosshairs fa-lg\"/>\n          </button>\n        </Control>\n\n        <LayersControl position=\"topleft\">\n          <BaseLayer name=\"Open Street Map\" checked={true}>\n            <TileLayer\n              url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n              attribution=\"&copy; <a href=&quot;http://osm.org/copyright&quot;>\n                OpenStreetMap</a> contributors\" />\n          </BaseLayer>\n\n          <BaseLayer name=\"ESRI Ocean Map\">\n            <TileLayer\n              url=\"https://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/{z}/{y}/{x}\"\n              attribution=\"&copy;\n                Esri, GEBCO, NOAA, National Geographic, DeLorme, HERE, Geonames.org, and other contributors\"/>\n          </BaseLayer>\n\n          <BaseLayer name=\"ESRI World Imagery\">\n            <TileLayer\n              url=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\n              attribution=\"&copy;\n                Esri, DigitalGlobe, Earthstar Geographics, CNES/Airbus DS,\n                GeoEye, USDA FSA, USGS, Aerogrid, IGN, IGP, and the GIS User Community\"/>\n          </BaseLayer>\n        </LayersControl>\n\n        {this.renderGeojsons()}\n\n        {this.addLayerControls()}\n\n        <Control position=\"topleft\">\n          <form className=\"leaflet-control-layers upload-form\">\n\n            Upload HRA Output Folder\n            <input type=\"file\" ref=\"fileUpload\"\n              onChange={e => this.onFileUpload(e.target.files, false)}\n              webkitdirectory=\"true\" mozdirectory=\"true\" msdirectory=\"true\"\n              odirectory=\"true\" directory=\"true\"\n              style={{\"display\": \"none\"}} multiple />\n            <br />\n\n            <input type=\"button\" value=\"Select Folder\"\n              onClick={e => this.refs.fileUpload.click()}/>\n\n            or View Sample\n            <input type=\"button\" value=\"Sample Files\"\n              onClick={e => this.viewSample(e)}/>\n          </form>\n\n        </Control>\n\n        <Control position=\"bottomleft\">\n          <div className=\"coords\">{this.state.coordText}</div>\n        </Control>\n\n        <Control position='bottomright' key='legend'>\n          <ul className='legend'>\n            {this.state.legend}\n          </ul>\n        </Control>\n\n        <ScaleControl position={\"bottomleft\"} maxWidth={100}/>\n        </Map>\n      </div>\n    );\n  }\n}\n\n// Use redux API to create csvUrl & vectorsOnMap props connected to the redux state\nfunction mapStateToProps(state) {\n  return {\n    csvUrl: state.csvUrl,\n    vectorsOnMap: state.vectorsOnMap,\n    fileSuffix: state.fileSuffix,\n  }\n}\n\n// Return getCsvUrl, getVectorsOnMap & getFileSuffix callback props\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({ getCsvUrl, getVectorsOnMap, getFileSuffix }, dispatch);\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Hramap);\n","import React from 'react';\nimport './style.css';\n\nclass Navi extends React.Component {\n  render() {\n    const { title } = this.props;\n    return (\n      <div className=\"navbar\">\n        <h1 className=\"navbar-brand\">{title}</h1>\n      </div>\n    );\n  }\n}\nexport default Navi;\n","// Reference: https://github.com/rma-consulting/react-easy-chart/blob/master/examples/Legend.js\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Style } from 'radium';\n\n\nconst legendStyles = {\n  '.legend': {\n    border: 'solid silver 1px',\n    backgroundColor: 'rgba(255, 255, 255, 0.55)',\n    borderRadius: '3px',\n    padding: '5px',\n    maxWidth: '200px',\n    wordBreak: 'break-all',\n    marginLeft: '100px',  // marginRight: '150px',\n    float: 'left', // right\n    textAlign: 'left'\n  },\n  '.legend li': {\n    width: '80%',\n    lineHeight: '18px',\n    paddingLeft: '20px',\n    paddingBottom: '2px',\n    position: 'relative',\n    fontSize: '13px',\n    float: 'left'\n  },\n  '.legend .icon': {\n    width: '10px',\n    height: '10px',\n    background: 'white',\n    borderRadius: '6px',\n    position: 'absolute',\n    left: '3px',\n    top: '50%',\n    marginTop: '-6px',\n  }\n};\n\n\nclass Legend extends React.Component {\n\n  static get propTypes() {\n    return {\n      config: PropTypes.array,\n    };\n  }\n\n  getList() {\n    return (\n      this.props.config.map(\n        (item, index) => (\n          <li key={index}>\n            <span\n              className=\"icon\"\n              style={{ backgroundColor: this.getIconColor(index) }}\n            />\n            {item.type}\n          </li>\n        )\n      )\n    );\n  }\n\n  getIconColor(index) {\n    const {\n      config\n    } = this.props;\n\n    return config[index].color;\n  }\n\n  render() {\n    if (this.props.config.length > 0) {\n      return (\n        <div className=\"legend-container\">\n          <Style scopeSelector=\".legend-container\" rules={legendStyles} />\n          <ul className=\"legend\">{this.getList()}</ul>\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default Legend;\n","// Reference: https://github.com/rma-consulting/react-easy-chart/blob/master/examples/ToolTip.js\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Style } from 'radium';\n\nconst toolTipStyles = {\n  '.tooltip': {\n    border: 'solid silver 0.5px',\n    position: 'absolute',\n    backgroundColor: 'rgba(255,255,255,0.9)',\n    borderRadius: '4px',\n    paddingLeft: '5px',\n    paddingRight: '5px',\n    paddingTop: '1px',\n    paddingBottom: '1px',\n    display: 'inline-block',\n    fontSize: '12px',\n    textAlign: 'center'\n  }\n};\n\nconst ToolTip = (props) => (\n  <div className=\"tooltip-container\">\n    <Style scopeSelector=\".tooltip-container\" rules={toolTipStyles} />\n    <div className=\"tooltip\" style={{ top: props.top, left: props.left }}>\n      {props.children}\n    </div>\n  </div>\n);\n\nToolTip.propTypes = {\n  left: PropTypes.string,\n  top: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport default ToolTip;\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport Papa from 'papaparse';\nimport palette from 'google-palette';\nimport { ScatterplotChart } from 'react-easy-chart';\nimport Legend from './Legend';\nimport ToolTip from './ToolTip';\n\nimport './style.css';\n\n\n// Header names in stats CSV file\nconst HABITAT_HEADER = 'HABITAT';\nconst STRESSOR_HEADER = 'STRESSOR';\nconst EXPOSURE_HEADER = 'E_MEAN';\nconst CONSEQUENCE_HEADER = 'C_MEAN';\nconst SUBREGION_HEADER = 'SUBREGION'\nconst HIGH_RISK_HEADER = 'R_%HIGH';\nconst MED_RISK_HEADER = 'R_%MEDIUM';\nconst LOW_RISK_HEADER = 'R_%LOW';\n\n// Default layer on map when files are uploaded\nconst ECOSYSTEM_RISK_LAYER = \"RECLASS_RISK_Ecosystem\";\n\n// Prefix of risk rasters\nconst RISK_PREFIX = \"RECLASS_RISK_\"\n\nclass riskPlots extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      csvUrl: props.csvUrl, // provided by connect@mapStateToProps\n      vectorsOnMap: props.vectorsOnMap, // same as above\n      fileSuffix: props.fileSuffix,\n      showToolTip: false,\n      dataToRender: {},\n      colorConfig: [],\n      legendColorConfig: [],\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.csvUrl !== null & nextProps.csvUrl !== undefined) {\n      this.setState({\n         csvUrl: nextProps.csvUrl,\n         vectorsOnMap: nextProps.vectorsOnMap,\n         fileSuffix: nextProps.fileSuffix,\n      }, () => {\n        // Parse zonal statistics data from CSV\n        Papa.parse(nextProps.csvUrl, {\n          header: true,\n          download: true,\n          skipEmptyLines: true,\n          complete: results => this.convertData(results.data)\n        });\n      });\n    }\n  }\n\n  // Process CSV data to dataToRender state for ScatterplotChart to render\n  convertData(csvData) {\n    // Use vectorsOnMap as a reference for what data to render\n    const vectorsOnMap = this.state.vectorsOnMap;\n    const fileSuffix = this.state.fileSuffix;\n\n    // Get a dictionary of subregions as keys and data points as values\n    let dataToRender = {};\n\n    // Get habitats on map in order to generate color palette in plots\n    let habitatsOnMap = [];\n\n    // Get a list of all the habitats\n    let habitatsAll = [];\n\n    Object.values(csvData).forEach( row => {\n      let subregion = row[SUBREGION_HEADER];\n      // Add suffix to habiat header, because all vector files will have\n      // suffix appended.\n      let habitatName = row[HABITAT_HEADER] + fileSuffix;\n\n      // Add habitat name to the all habitats list\n      if (!habitatsAll.includes(habitatName)) {\n        habitatsAll.push(habitatName); // add habitat name to the array\n      }\n\n      // Render data points for that habitat layer if it's checked or if\n      // ECOSYSTEM_RISK_LAYER is checked on map control\n      if (vectorsOnMap.includes(RISK_PREFIX + habitatName) ||\n          vectorsOnMap.includes(ECOSYSTEM_RISK_LAYER + fileSuffix)) {\n\n        // Add habitat name to the legend list\n        if (!habitatsOnMap.includes(habitatName)) {\n          habitatsOnMap.push(habitatName); // add habitat name to the array\n        }\n\n        // Add the data point for the stressor and habitat to state\n        let dataPoint = {\n          type: habitatName,\n          stressor: row[STRESSOR_HEADER],\n          x: row[EXPOSURE_HEADER],\n          y: row[CONSEQUENCE_HEADER],\n          highRisk: row[HIGH_RISK_HEADER],\n          medRisk: row[MED_RISK_HEADER],\n          lowRisk: row[LOW_RISK_HEADER]\n        };\n\n        // Push data to the array for the subregion key in dataToRender\n        if (!dataToRender[subregion]) {\n          dataToRender[subregion] = [dataPoint];\n        }\n        else {\n          dataToRender[subregion].push(dataPoint);\n        }\n      }\n    });\n\n    this.setState({ dataToRender, habitatsAll, habitatsOnMap });\n    this.createColorConfig();\n  }\n\n  // Create color hexes for habitats in scatter plots and legend\n  createColorConfig() {\n    const habitatsAll = this.state.habitatsAll;\n    const habitatsOnMap = this.state.habitatsOnMap;\n\n    // Get Paul Tol's rainbow scheme, color-blind friendly\n    const colors = palette('tol', habitatsAll.length)\n\n    let colorConfig = [];\n    let legendColorConfig = [];\n\n    for (let i=0; i < habitatsAll.length; i++) {\n      let habitatName = habitatsAll[i]\n      // Push every habitat to the color config for plots, so the plots\n      // have consistent color scheme for habitats\n      colorConfig.push(\n        {\n          type: habitatName,\n          color: '#' + colors[i]\n        }\n      );\n\n      // Only push habitats that are on the map to the legend\n      if (habitatsOnMap.includes(habitatName)) {\n        legendColorConfig.push(\n          {\n            type: habitatName,\n            color: '#' + colors[i]\n          }\n        );\n      }\n    }\n\n    if (colorConfig.length === habitatsAll.length) {\n      this.setState({ colorConfig });\n      this.setState({ legendColorConfig });\n    }\n  }\n\n  createScatterPlot() {\n    if ( this.state.dataToRender ) {\n      const dataToRender = this.state.dataToRender;\n      const subregions = Object.keys(dataToRender);\n      const scatterPlots = subregions.map( subregion => {\n        // Find max x and y values among all the data points\n        const x_max = Math.max.apply(\n          Math, Object.values(\n            dataToRender[subregion]).map(dataPoint => dataPoint.x));\n        const y_max = Math.max.apply(\n          Math, Object.values(\n            dataToRender[subregion]).map(dataPoint => dataPoint.y));\n        // Make extra space for the plot by multiplying 1.1\n        const max_domain = Math.max(x_max, y_max) * 1.1;\n\n        return (<div key={subregion}>\n          <h4>{subregion}</h4>\n          <ScatterplotChart\n            key={subregion}\n            data={dataToRender[subregion]}\n            margin={{top: 10, right: 0, bottom: 25, left: 65}}\n            config={this.state.colorConfig}\n            axes\n            xTicks={7}\n            yTicks={7}\n            axisLabels={{x: 'Exposure', y: 'Consequence'}}\n            dotRadius={6}\n            width={400}\n            height={300}\n            xDomainRange={[0, max_domain]}\n            yDomainRange={[0, max_domain]}\n            mouseOverHandler={this.mouseOverHandler.bind(this)}\n            mouseOutHandler={this.mouseOutHandler.bind(this)}\n          />\n        </div>)\n      });\n\n      return scatterPlots\n    }\n  }\n\n  // Show tool tip on top of data point when mouse hovers over\n  mouseOverHandler(d, e) {\n    this.setState({\n      showToolTip: true,\n      top: `${e.clientY - 60}px`,\n      left: `${e.clientX - d.stressor.length * 3.5}px`,  // roughly center the element\n      habitatName: d.type,\n      stressorName: d.stressor,\n      conseqValue: Number(d.y),\n      expoValue: Number(d.x)\n    });\n  }\n\n  mouseOutHandler() {\n    this.setState({ showToolTip: false });\n  }\n\n  createTooltip() {\n    if (this.state.showToolTip) {\n      return (\n        <ToolTip top={this.state.top} left={this.state.left}>\n          <span className='tooltip-title'> {this.state.stressorName} </span>\n          <br />\n          <span className='tooltip-title'> {this.state.habitatName} </span>\n          <br />\n          E: {this.state.expoValue.toFixed(2)},\n          C: {this.state.conseqValue.toFixed(2)}\n\n        </ToolTip>\n      );\n    }\n    return false;\n  }\n\n  createLegend() {\n    if ( Object.values(this.state.dataToRender).length > 0 ) {\n      return(\n        <div className='legend-div'>\n          <Legend config={this.state.legendColorConfig} />\n        </div>\n      );\n    }\n  }\n\n  defaultParagraph() {\n    const welcomeText = \"Welcome to the Habitat Risk Assessment \" +\n      \"visualization platform!\"\n\n    const explainText = \"Please click on the button on the left of the map \" +\n       \"to upload your output data folder from the HRA model, in order to \" +\n       \"view the results on map and plots. You can also view sample files \" +\n       \"to expect what they look like.\";\n\n    if (!this.state.csvUrl) {\n      return (\n        <div className='default-p'>\n          <p>{welcomeText}</p>\n          <p>{explainText}</p>\n        </div>\n      );\n    } else {\n      return null\n    }\n  }\n\n  render() {\n\n    return (\n      <div className='plot-container'>\n        <h3 className='header'>Risk Plots</h3>\n\n        {this.createLegend()}\n\n        {this.defaultParagraph()}\n\n        {this.createScatterPlot()}\n\n        {this.createTooltip()}\n\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  csvUrl: state.csvUrl,\n  vectorsOnMap: state.vectorsOnMap,\n  fileSuffix: state.fileSuffix,\n});\n\nexport default connect(mapStateToProps)(riskPlots);\n","import React, { Component } from 'react';\nimport Footer from './components/Footer';\nimport HraMap from './components/Map';\nimport Navi from './components/Navi';\nimport Plot from './components/Plot';\nimport './App.css';\n\nclass App extends Component {\n\n  constructor(props) {\n    super (props); // Required to call original constructor\n    this.state = {\n      title: \"Habitat Risk Assessment\"\n    }\n  }\n\n  // Alert users if browser type is not Chrome, Opera, or Firefox\n  checkBrowser(alert) {\n    // Chrome 1+\n    let isChrome = !!window.chrome && !!window.chrome.webstore;\n    // Opera 8.0+\n    let isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;\n    // Firefox 1.0+\n    let isFirefox = typeof InstallTrigger !== 'undefined';\n\n    if (!(isChrome | isOpera | isFirefox)) {\n      window.alert('It is suggested to use Chrome, Opera, or Firefox to get the best performance on this web page.');\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Navi title={this.state.title}/>\n        <HraMap />\n        <Plot />\n        <Footer />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { createStore } from 'redux';\nimport { Provider } from 'react-redux';\nimport rootReducer from './reducers';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport './index.css';\n\nconst store = createStore(rootReducer)\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}